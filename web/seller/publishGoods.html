<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" href="/css/style.css"/>
    <link rel="stylesheet" href="/css/layui.css" media="all"/>
    <script src="/js/common/common.js"></script>
    <script src="/js/common/_head.js"></script>
    <script src="/js/common/_sellMenu.js"></script>
    <script src="/js/module/seller/publishGoods.js"></script>
    <title>卖家个人中心-发布商品</title>
</head>
<body>
<div class="top"></div>
<div class="nav">
    <div class="auto">
        <a href="/index.html"><img src="/img/nav_logo.png" class="fl"/></a>
        <div class="nav_shop fl" style="margin-top: 40px;">
            <h3 style="margin-top: 10px;">卖家个人中心</h3>
        </div>

        <div class="enter_myorders" class="fr">
            <img src="/img/icon_nav_orders_color.png" class="fl m1"/>
            <img src="/img/icon_nav_orders_white.png" class="fl m2" style="display: none;"/>
            <h4 class="fr">我的订单</h4>
        </div>
    </div>
</div>

<div class="center auto">
    <!--左侧菜单-->
    <div class="fl center_left" id="menuCenter"></div>
    <!--右侧内容区-->
    <div class="fl center_right">
        <h1 class="record_title"><a href="/index.html">首页</a>&nbsp;>&nbsp;<a>卖家中心</a>&nbsp;>&nbsp;发布商品</h1>
        <div class="publish">
            <div class="publish_box" style="margin-top: 40px;">
                <h3>商品标题：</h3>
                <input type="text" id="goodsName" placeholder="请输入该商品的标题" style="width: 500px;" maxlength="60"/>
            </div>
            <div class="publish_box">
                <h3>商品金额(元)：</h3>
                <input type="text" id="shopPrice" onkeyup="this.value=this.value.replace(/[^\d\.]/g,'')"  placeholder="填写商品单价" style="width: 200px;" maxlength="15"/>
                <h3 style="width: 118px;">定金比例：</h3>
                <input type="text" id="depositRatio" onkeyup="this.value=this.value.replace(/[^\d\.]/g,'')"   style="width: 180px;" maxlength="3"/>
                <h4>%</h4>
            </div>
            <div class="publish_box">
                <h3>是否包邮：</h3>
                <select id="isFreeShipping" style="width: 200px;">
                    <option value="1">是</option>
                    <!--<option value="0">否</option>-->
                </select>
            </div>
        </div>
        <div class="publish">
            <h1><span>商品属性：</span>错误填写商品属性，可能会引起商品下架或搜索流量减少，影响您的正常销售，请认真准确填写！</h1>
            <div class="publish_box">
                <h3>品类：</h3>
                <input type="hidden" id="catIdVal">
                <select id="catId" style="width: 200px"></select>
                <h3 style="width: 98px;">品种：</h3>
                <input type="text" id="breeds" style="width: 200px;"/>
            </div>
            <div class="publish_box">
                <h3>生长周期：</h3>
                <input type="text" id="plantingCycle" onpaste="return false" onkeyup="this.value=this.value.replace(/[^\d\.]/g,'')" maxlength="3" style="width: 200px;"/>
                <h4 style="left: 310px;color: #333333;">天</h4>
            </div>
            <div class="publish_box">
                <h3>种植时间：</h3>
                <select style="width: 150px;" id="startPlantime">
                </select>
                <h3 style="width: 50px;text-align: center;">至</h3>
                <select style="width: 150px;" id="endPlantime">
                </select>
            </div>
            <div class="publish_box">
                <h3>预计单位产量：</h3>
                <input type="text" id="expectPartOutput" onkeyup="this.value=this.value.replace(/[^\d\.]/g,'')" style="width: 200px;" onchange="showGoodsArea()" maxlength="18"/>
                <h4 style="left: 310px;color: #333333;">kg</h4>
            </div>
        </div>
        <div class="publish">
            <h1><span>土地属性：</span>错误填写商品属性，可能会引起商品下架或搜索流量减少，影响您的正常销售，请认真准确填写！</h1>
            <div class="publish_box">
                <h3>土地编号：</h3>
                <input type="text" id="landSn" onkeyup="this.value=this.value.replace(/[^\d\.]/g,'')" style="width: 200px;"  maxlength="15"/>
                <h3 style="width: 118px;">土地所在地：</h3>
                <input type="text" id="landAddress" style="width: 200px;" maxlength="30"/>
            </div>
            <div class="publish_box">
                <h3>每单位土地面积：</h3>
                <input type="text" id="landPartArea" onkeyup="this.value=this.value.replace(/[^\d\.]/g,'')" style="width: 200px;" onchange="showGoodsArea()" maxlength="18"/>
                <h4 style="left: 310px;color: #333333;">亩</h4>
                <h3 style="width: 118px;">所属农户：</h3>
                <select id="farmerId" style="width: 200px"></select>
            </div>
        </div>
        <div class="publish">
            <div class="publish_box" style="margin-top: 40px;">
                <h3>上架库存数：</h3>
                <input type="text" id="goodsNumber" onkeyup="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'1')}else{this.value=this.value.replace(/\D/g,'1')}" style="width: 200px;" onchange="showGoodsArea()" maxlength="15"/>
                <h4 style="left: 310px;color: #333333;">件</h4>
                <h5 id="showGoodsArea">总面积：约0亩 &nbsp;&nbsp;&nbsp;&nbsp;总产量：约0KG</h5>
            </div>
        </div>
        <div class="publish">
            <h1 class="layui-icon layui-icon-delete" style="text-align: left"><span>商品主图：</span>宝贝主图大小不能超过3MB，最多允许上传5张
            </h1>
            <input type="hidden" id="goodsMasterImgs">
            <ul class="upload" id="showMasterImgs">
                <li>
                    <img src="/img/bg_upload.png" id="uploadMasterImg" style="width: 150px;height: 150px">
                    <input type="file" accept="image/*"/>
                </li>
            </ul>
            <h1 style="margin-top: 30px;text-align: left"><span>商品土地图：</span>土地图大小不能超过3MB，最多允许上传1张，上传规范的土地图片，能让您的商品详情显示效果更好。
            </h1>
            <input type="hidden" id="landImgs">
            <ul class="upload" id="showLandImgs">
                <li>
                    <img src="/img/bg_upload.png" id="uploadLandImg" style="width: 150px;height: 150px">
                    <input type="file" accept="image/*"/>
                </li>
            </ul>
            <h1 style="margin-top: 30px;text-align: left;"><span>商品详情图：</span>详情大小不能超过3MB，最多允许上传3张</h1>
            <input type="hidden" id="goodsDescImgs">
            <ul class="upload" style="margin-bottom: 30px;" id="showDescImgs">
                <li>
                    <img src="/img/bg_upload.png" id="uploadDescImg" style="width: 150px;height: 150px">
                    <input type="file" accept="image/*"/>
                </li>
            </ul>
        </div>
        <div class="publish">
            <div class="publish_box" style="margin-top:30px;">
                <h3>电脑端商品描述：</h3>
                <textarea id="goodsDesc" style="width: 450px;height: 150px" placeholder="商品描述，0-1200字符，600字以内" maxlength="1000"></textarea>
            </div>
            <div class="publish_box">
                <h3>认购时限：</h3>
                <div class="layui-form">
                    <div class="layui-input-inline">
                        <input type="text" style="width: 230px" id="subscribeTime" placeholder="请选择认购时限" class="layui-input">
                    </div>
                </div>
            </div>
        </div>
        <div class="btn_submit" style="margin-bottom: 50px;margin-top: 45px;">
            <h3 onclick="publishGoods()" id="publishGoods">发布商品</h3>
        </div>
    </div>
</div>

<script src="/js/common/_side.js"></script>
<script src="/js/common/_foot.js"></script>
<script>
    /**
     * 上传图片
     */
    layui.use('upload', function () {
        var $ = layui.jquery, upload = layui.upload;
        var masterImg = "";
        var landImg = "";
        var descImg = "";
        //商品主图片上传
        upload.render({
            elem: '#uploadMasterImg'
            , url: SERVER_URL + '/upload/goodsImage'
            , size: 3000
            , before: function (obj) {
                console.log(masterImg.split(",").length);
                if (masterImg.split(",").length > 2) {
                    return layer.msg("最多允许上传5张图片", {icon: 2});
                }
                //预读本地文件示例，不支持ie8
                obj.preview(function (index, file, result) {
                    $('#showMasterImgs').append('<li><img src="' + result + '" alt="' + file.name + '" style="width: 150px;height: 150px"></li>')
                });
            }
            , done: function (res) {
                var code = res.code;
                var message = res.message;
                console.log("message==" + message);
                //如果上传失败
                if (200 != code) {
                    return layer.msg("上传失败,重试", {icon: 2});
                } else {
                    masterImg += message + ",";
                }
                console.log("mainImg:" + masterImg);
                $('#goodsMasterImgs').val(masterImg.substr(0, masterImg.length - 1));
            }
        });

        //商品土地图
        upload.render({
            elem: '#uploadLandImg'
            , url: SERVER_URL + '/upload/goodsImage'
            , size: 3000
            , before: function (obj) {
                console.log(landImg.split(",").length);
                if (landImg.split(",").length > 2) {
                    return layer.msg("最多允许上传1张图片");
                }
                obj.preview(function (index, file, result) {
                    $('#showLandImgs').append('<li><img src="' + result + '" alt="' + file.name + '" style="width: 150px;height: 150px"></li>')
                });
            }
            , done: function (res) {
                var code = res.code;
                var message = res.message;
                console.log("message==" + message);
                if (200 != code) {
                    return layer.msg('上传失败,重试');
                } else {
                    landImg += message + ",";
                }
                console.log("landImg:" + landImg);
                $('#landImgs').val(landImg.substr(0, landImg.length - 1));
            }
        });

        //商品详情图
        upload.render({
            elem: '#uploadDescImg'
            , url: SERVER_URL + '/upload/goodsImage'
            , size: 3000
            , before: function (obj) {
                console.log(descImg.split(",").length);
                if (descImg.split(",").length > 4) {
                    return layer.msg("最多允许上传3张图片");
                }
                obj.preview(function (index, file, result) {
                    $('#showDescImgs').append('<li><img src="' + result + '" alt="' + file.name + '" style="width: 150px;height: 150px"></li>')
                });
            }
            , done: function (res) {
                var code = res.code;
                var message = res.message;
                console.log("message==" + message);
                if (200 != code) {
                    return layer.msg('上传失败,重试');
                } else {
                    descImg += message + ",";
                }
                console.log("descImg:" + descImg);
                $('#goodsDescImgs').val(descImg.substr(0, descImg.length - 1));
            }
        });
    });
</script>
<script>
    layui.use('laydate', function () {
        var laydate = layui.laydate;
        //执行一个laydate实例
        laydate.render({
            elem: '#subscribeTime', //指定元素
            range: '至',
            min: '0'
        });
    });
</script>
</body>
</html>
